\documentclass[11pt,a4paper]{article}
\textheight245mm
\textwidth170mm
\hoffset-21mm
\voffset-15mm
\parindent0pt
\usepackage[utf8]{inputenc}
\usepackage{dsfont}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{fancyhdr}
\usepackage{amsmath,amsfonts,amssymb}
\usepackage[french]{babel}
\usepackage[maxalphanames=99, maxnames=99, backend=bibtex, style=alphabetic, sorting=ynt]{biblatex}
\addbibresource{rapport-stage.bib}
\usepackage[hidelinks]{hyperref} 
\hypersetup{
  colorlinks   = true,    % Colours links instead of ugly boxes
  urlcolor     = black,    % Colour for external hyperlinks
  linkcolor    = black,    % Colour of internal links
  citecolor    = black      % Colour of citations
}
\usepackage{zephyr}
\pagestyle{fancy}

\usepackage{array,multirow,makecell}
\setcellgapes{4pt}
\makegapedcells
\newcolumntype{R}[1]{>{\raggedleft\arraybackslash }b{#1}}
\newcolumntype{L}[1]{>{\raggedright\arraybackslash }b{#1}}
\newcolumntype{C}[1]{>{\centering\arraybackslash }b{#1}}

\renewcommand{\headrulewidth}{1pt}
\fancyhead[C]{}
\fancyhead[L]{L3 - 2022/2023}
\fancyhead[R]{D.E.R Informatique}

\renewcommand{\footrulewidth}{1pt}
\fancyfoot[C]{\thepage} 
\fancyfoot[L]{Sacha Ben-Arous}
\fancyfoot[R]{E.N.S Paris-Saclay}

\title{\textbf{Étude du problème MP-LWE}}
\date{}
\author{Sacha Ben-Arous, sous la direction d'Alice Pellet-Mary}





%Simul pour unif et comparer avec notre cas
% Proba que colonnes indeps
%Rot(a)^-1 = Rot(a^-1)

% EXEMPLES FACTEUR DEXP BORNE
% PARLER DE LYUBASHEVSKI
% METTRE DES HYPER LIENS 
%PARLER DU SCHEMA DE CHIFFREMENT ?








\begin{document}
\maketitle 
\begin{abstract}
Insérer abstract ici \\
\end{abstract}
\tableofcontents
\newpage
\section{Introduction}
\; Les réseaux euclidiens sont une construction algébrique permettant entre autres de définir des problèmes mathématiques dont la résolution algorithmique est conjecturée difficile, même pour des ordinateurs quantiques. Cela les rend donc particulièrement intéressants pour construire des protocoles sûrs en cryptographie post-quantique. \\
Deux exemples fondamentaux de problèmes sur les réseaux sont le \textit{Small Integer Solutions problem} (SIS) introduit par Ajtai en 1996, et le \textit{Learning With Errors problem} (LWE), découvert par Regev en 2005. \\
Le problème LWE est privilégié dans la construction de schémas de chiffrement car il été prouvé \cite{wcac} que résoudre une instance aléatoire de LWE est aussi dur que résoudre la pire instance d'un problème dur (cf suite). On dit que LWE bénéficie d'une réduction \textit{pire-cas moyen-cas}. \\
Cependant, si l'on utilise la version standard de LWE pour construire des protocoles, ces derniers auront une efficacité très réduite à cause d'opérations faisant intervenir de grandes matrices aléatoires. La variante \textit{Polynomial Learning With Errors}, proposée par Stehlé \textit{et al.} \cite{plwe}, résout ce problème en utilisant des réseaux structurés : les calculs matriciels correspondent alors à des produits de polynômes, calculables très efficacement. Cependant, ce gain d'efficacité se fait au détriment de garanties de sécurité : les polynômes sont manipulés dans $\mathbb{Z}_p[X]/f$ et la complexité de la variante est directement liée au $f$ choisi. \\
Afin de se débarasser de cette dépendance, Roşca \textit{et al.} introduisent le \textit{Middle-Product Learning With Errors problem} (MP-LWE) \cite{mplwe} dont l'intérêt est d'être aussi dur que des classes exponentiellement grandes de problèmes PLWE($f$) (dont on espère qu'elles contiennent au moins une instance difficile), tout en conservant l'efficacité des réseaux structurés. \\

Durant mon stage, j'ai donc travaillé sur la variante MP-LWE du problème de Regev, et plus particulièrement sur les effets de la réduction de PLWE vers MP-LWE proposée par \cite{mplwe}.
\\

\section{Préliminaires}
\begin{defin} 
Un \textit{réseau euclidien} de $\mathbb{R}^m$ est l'ensemble des combinaisons à coefficients entiers de vecteurs linéairements indépendants $b_1, \dots, b_n$, que l'on note :
\[\mathcal{L}(b_1,\dots,b_n) := \left\{ \sum_{i=1}^n x_ib_i, x_i \in \mathbb{Z} \right\} \]

Le réseau est alors de \textit{dimension} $n$, et la famille des $(b_i)_{1\leq i \leq n}$ est appelée \textit{base} de ce réseau. \\

En notant $B:=[b_1,\dots,b_n]$ la matrice dont les colonnes sont formées par les $(b_i)_{1\leq i \leq n}$, on considérera de manière équivalente : \[\mathcal{L}(B) := \left\{ Bx, x \in \mathbb{Z}^n \right\} \]
\end{defin}

Dans ce qui suit, on note $\mathbb{Z}_q$ (resp. $\mathbb{R}_q$) le quotient $\mathbb{Z}/q\mathbb{Z}$ (resp. $\mathbb{R}/q\mathbb{Z}$), et $\|.\|$ désigne la norme euclidienne.

\subsection{Problème LWE et difficulté}

\begin{defin}\textbf{(Distribution LWE)}
Soient $q\geq 2$, $m\geq 1$, $\chi$ une distribution de probabilité sur $\mathbb{Z}$. À partir de $s\in \mathbb{Z}_q^m$, on définit $\mathcal{D}_{q,\chi,m}$ la distribution sur $\mathbb{Z}_q^m\times\mathbb{Z}_q$ obtenue en choisissant $a \hookleftarrow \mathcal{U}(\mathbb{Z}_q^m)$, $e\hookleftarrow \chi$, et qui renvoie $(a,b):=(a,\left<a,s\right> +e \text{ mod } q)$.
\end{defin}

\begin{defin}\textbf{(Problèmes LWE)}
Soient $q\geq 2$, $m\geq 1$, $\chi$. Muni de la distribution $\mathcal{D}_{q,\chi,m}$ précédente, on peut alors définir deux problèmes : 
\begin{enumerate}
\item[•]\textbf{LWE-Décisionnel} consiste à un distinguer un nombre arbitraire d'échantillons de $\mathcal{D}_{q,\chi,m}$ et le même nombre d'échantillons de $\mathcal{U}(\mathbb{Z}_q^m)\times\mathcal{U}(\mathbb{Z}_q)$.
\item[•]\textbf{LWE-Calculatoire} consiste à retrouver le secret $s$ à partir d'un nombre fixé d'échantillons indépendants.
\end{enumerate}
\end{defin}

En notant $A$ la matrice dont les lignes sont formées des ($a_i)_{i\leq t}$, $e:=(e_i)_{i\leq t}$ et $b:=(b_i)_{i\leq t}$ ($t$ représente le nombre d'échantillons), on a : $b=As +e \text{ mod } q$.

\begin{defin}
Dans un réseau $\Lambda$, on note $\lambda_i := \inf\{r,\dim(\text{Vect}(\Lambda\cap\mathcal{B}(0,r))=i\}$ le i-ème minimum du réseau. En particulier, on a $\lambda_1 = \inf\{\|v\| ,  v \in \mathcal{L}(B)/\{0\}\}$ qui est le plus court vecteur non nul du réseau.
\end{defin}

\underline{Rq} : $\lambda_i$ s'interprète comme le rayon de la plus petite boule centrée à l'origine qui contient $i$ vecteurs indépendants du réseau. \\ Le calcul effectif de ces minimums semble très dur : les meilleurs algorithmes polynomiaux connus calculant $\lambda_1$ ont un facteur d'approximation exponentiel. \\

On peut alors considérer le problème algorithmique suivant, qui apparait lors de l'étude des réseaux reliés aux protocoles utilisant LWE : 

\begin{defin}\textbf{(BDD)}
Soit $B$ une base d'un réseau de dimension $n$, et $\gamma \in \mathbb{R}^+$. Une instance du problème \textit{Bounded Distance Decoding} est un vecteur $t \in \mathbb{R}^m$ de la forme $t=x+e$, où $x\in \mathcal{L}(B)$ et $\|e\| \leq \lambda_1/\gamma$. Le problème consiste à retrouver $x$ (ou $e$) à partir de $t$.
\end{defin}

En revenant au problème LWE-Décisionnel, on constate que ce dernier se réduit à une instance de BDD dans le réseau engendré par les colonnes de $[A|qId_t]$.

\begin{conj}
Dans un réseau de dimension $n$, pour $\gamma$ polynomial en $n$, le problème BDD est conjecturé exponentiellement (en $n$) dur à résoudre, même sur des ordinateurs quantiques.
\end{conj}

\subsection{Variantes structurées}

On considère la variante polynomiale du problème LWE :
\begin{defin}\textbf{(Distribution PLWE)}
Soient $q \geq 2$, $m>0$, $f$ polynôme de degré $m$, $\chi$ une distribution sur $\mathbb{R}_q[X]/f$. À partir de $s\in \mathbb{Z}_q[X]/f$, on défini la distribution $\text{P}^{(f)}_{q,\chi}(s)$ sur $\mathbb{Z}_q[X]/f \times \mathbb{R}_q[X]/f$ obtenue en tirant $a \hookleftarrow \mathcal{U}(\mathbb{Z}_q[X]/f)$, $e\hookleftarrow \chi$ et qui renvoie $(a,b=a\cdot s+e)$.
\end{defin}

Ensuite, on définit un nouveau produit sur les polynômes : 
\begin{defin}\textbf{(Middle-Product)}
Soient $d_a,d_b,d,k \in \mathbb{N}$ tels que $d_a+d_b-1=d+2k$. Alors le \textit{middle-product} $\odot_d : \mathbb{R}^{<d_a}[X]\times\mathbb{R}^{<d_b}[X]\to\mathbb{R}^{<d}[X]$ est la fonction :
\[(a,b) \mapsto a \odot_d b = \lfloor \frac{(a\cdot b)\text{ mod }x^{k+d}}{x^k} \rfloor\]
\end{defin}

On construit alors une distribution plus générale utilisant le produit précédent : 
\begin{defin}\textbf{(Distribution MP-LWE)}
Soient $n,d >0$, $q\geq 2$ et $\chi$ une distribution sur $\mathbb{R}_q^{<d}[X]$. Pour $s\in \mathbb{Z}^{n+d-1}$, on définit la distribution $\text{MP}_{q,n,d,\chi}(s)$ sur $\mathbb{Z}_q^{<n}[X]\times\mathbb{R}_q^{<d}$ obtenu en tirant $a \hookleftarrow \mathcal{U}(\mathbb{Z}_q^{<n}[X])$, $e\hookleftarrow \chi$ et qui renvoie $(a,b=a\odot_d s+e)$.
\end{defin}

Les problèmes décisionnels $\text{PLWE}^{(f)}_{q,\chi}$ et $\text{MP-LWE}_{q,n,d,\chi}$ associés peuvent se définir ensuite de manière parfaitement analogue au cas LWE classique. \\

\begin{defin} Soit $\sigma >0$ et $m \in \mathbb{N}$
\begin{enumerate}
\item[•] On note $D_\sigma$ la gaussienne en dimension $n$ dont la matrice de covariance est $\sigma^2\text{Id}_n$.
\item[•] Soit $f \in \mathbb{Z}[X]$ de degré $m$. On définit le \textit{facteur d'expansion} de $f$ 
par\\ $EF(f) :=\displaystyle \max_{\substack{g\in \mathbb{Z}^{2m-1}[X] \\ g \neq 0}}(\frac{\|g\text{ mod }f \|_\infty}{\|g\|_\infty})$
\end{enumerate}
\end{defin}


\begin{theorem}
Soient $n,d >0$, $q\geq 2$, et $\alpha \in (0,1)$. Pour $S>0$, on note $\mathcal{F}(S,d,n)$ les polynômes de $\mathbb{Z}[X]$ unitaires, dont le coefficient constant est inversible dans $\mathbb{Z}_q$, de degré $m$ vérifiant $d\leq m\leq n$, et tels que $\text{EF}(f)\leq S$. Il existe une réduction \textit{ppt} depuis $\text{PLWE}^{(f)}_{q,D_{\alpha q}}$ pour tout $f\in\mathcal{F}(S,d,n)$ vers  $\text{MP-LWE}_{q,n,d,D_{\alpha' q}}$, où $\alpha' = \alpha d S$.
\end{theorem}

Il s'agit du résultat principal de \cite{mplwe}. Durant mon stage, j'ai étudié comment la réduction explicitée dans la preuve du théorème agit géométriquement sur les réseaux sous-jacents aux problèmes de manière à en augmenter la complexité.

\section{Étude de la réduction}

Afin de manipuler les réseaux sous-jacents à ces variantes, il est nécessaire de défnir les objets suivants : 

\begin{defin} Soient $f,a\in \mathbb{R}_d[X]$ de degré $m$ et $n$, et $d \in \mathbb{N}$
\begin{enumerate}
\item[•] On note $\text{Rot}^d_f(a) \in \mathbb{R}^{d\times m}$ la matrice dont la $i$-ème ligne est constituée des coefficients de $a\cdot x^{i-1}\text{ mod } f$. On écrira $\text{Rot}_f(a)$ pour  $\text{Rot}^m_f(a)$
\item[•] On note $\text{Toep}^{d,n}(a) \in \mathbb{R}^{d\times(n+d-1)}$ la matrice dont la $i$-ème ligne est constituée des coefficients de $a\cdot x^{i-1}$.
\item[•] On note $\text{M}_f^d \in \mathbb{R}^{d\times m}$ la matrice dont l'entrée $(i,j)$ est le coefficient constant de $x^{i+j-2}\text{ mod }f$. On écrira $\text{M}_f$ pour  $\text{M}_f^m$.
\end{enumerate}
\end{defin}


Dans la suite, on notera de manière identique un polynôme et le vecteur de ses coefficients. De plus, pour un vecteur $a$, on notera $\bar a$ ce vecteur renversé. \\
\begin{lemma} Soient $d,k >0$, et $a \in \mathbb{R}^{<k+1}[X]$, $b \in \mathbb{R}^{<k+d}[X]$ et $f \in \mathbb{R}[X]$ de degré $m$, alors :
\begin{enumerate}
\item[(1)]$\text{Rot}^d_f(a) = \text{Toep}^{d,k+1}(a)\cdot\text{Rot}^{k+d}_f(1)$
\item[(2)] $a\odot_d b = \overline{\text{Toep}^{d,k+1}(a)\cdot \bar{b}}$
\item[(3)] $\text{Rot}_f(a\cdot b)=\text{Rot}_f(a)\cdot\text{Rot}_f(b)$
\item[(4)] Si $\text{deg}(a) < m$, $\text{Rot}_f(a)\cdot(1,0,\dots,0)^\top = \text{M}_f\cdot a$
\end{enumerate}
\end{lemma}
Les preuves calculatoires sont fournies dans \cite{mplwe}.

\subsection{Principe de la réduction}
% a_i puis b_i puis secret puis distrib	
Soient $q \geq 2$, $\alpha \in (0,1)$, $f$ polynôme vérifiant les hypothèses du Théorème 2.1, dont on gardera les notations. \\
 À partir de $s\in \mathbb{Z}_q[X]/f$, on se donne initialement un nombre $t$ d'échantillons $(a_i,b_i)_{i\leq t}$ de $\text{P}^{(f)}_{q,D_{\alpha q}}(s)$. Le but est de construire $t$ échantillons $(a'_i,b'_i)_{i\leq t}$ de $\text{MP}_{q,n,d,D_{\alpha'q}}(s)$. Dans un premier temps, on va "prolonger" les $a_i$ dans un espace de polynômes de plus grand degré. Ensuite grâce au Lemme 3.1 on passera du produit usuel dans l'espace quotient au middle-product. Il faudra alors re-randomiser le secret, et éliminer la dernière dépendance en $f$ dans la distribution de la nouvelle erreur. \\

Tout d'abord, on tire $(r_i)_{i\leq t} \hookleftarrow \mathcal{U}(\mathbb{Z}_q^{<n-m}[X])$, et on définit $a'_i := a_i + f\cdot r_i \in \mathbb{Z}_q^{<n}[X]$. On a alors que, les $a_i$ et $r_i$ étant uniformes, les $a'_i$ le sont aussi. Moralement, on rajoute la partie des $a_i$ qui a été oubliée en passant au quotient. La preuve formelle consitue le Lemme 2.1 de \cite{psis}. Elle se fait par récurrence, en utilisant de manière cruciale que $f$ est unitaire. \\

Ensuite, en utilisant le Lemme 3.1 et la définition des $(b_i)_{i\leq t}$, on a 
\[\text{Rot}_f(b_i)=\text{Rot}_f(a_i)\cdot\text{Rot}_f(s)+\text{Rot}_f(e_i)\]
Ce qui donne, en conservant la première colonne (i.e en multipliant par $(1,0,\dots,0)^\top$) et les $d$ premières lignes :
\begin{eqnarray*}
\text{M}_f^d\cdot b_i &=& \text{Rot}_f^d(a_i)\cdot\text{M}_f^d\cdot s +\text{M}_f^d\cdot e_i \\
&=& \text{Rot}_f^d(a'_i)\cdot\text{M}_f^d\cdot s +\text{M}_f^d\cdot e_i  \\
&=& \text{Toep}^{d,n}(a'_i)\cdot\text{Rot}^{d+n-1}_f(1)\cdot\text{M}_f^d\cdot s +\text{M}_f^d\cdot e_i  \\
\overline{b'_i}&=& \text{Toep}^{d,n}(a'_i)\cdot\overline{s'} + \overline{e'_i}
\end{eqnarray*}
où on a noté $\begin{cases} b'_i = \overline{\text{M}_f^d\cdot b_i} \\ s' = \overline{\text{Rot}^{d+n-1}_f(1)\cdot\text{M}_f^d\cdot s} \\ e'_i = \overline{\text{M}_f^d\cdot e_i} \end{cases}$ \\

Alors on a, toujours en utilisant le Lemme 3.1, que $b'_i = a'_i \odot_d s' + e'_i$ \\

On obtient que $b'_i$ est uniformément distribué car $b_i$ l'est, et que $\text{M}_f$ est inversible modulo $q$. Cette dernière affirmation repose sur l'hypothèse que le coefficient constant de $f$ est inversible modulo $q$. \\

Ensuite, on constate que le nouveau secret est encore fortement lié au secret de l'ancien réseau. Pour régler ce problème, on prend $s'' \hookleftarrow \mathcal{U}(\mathbb{Z}_q^{n+d-1}[X])$ et on en sortie, on ajoute à chaque $(a'_i,b'_i)$ le couple $(0,a'_i\odot_d s'')$, de manière à re-randomiser le secret, i.e : le nouveau secret $\tilde s = s'+s''$ est maintenant uniforme dans le nouveau réseau.  \\

On a de plus que, en notant $J \in \mathbb{R}^{d\times d}$ la matrice qui a des $1$ sur son anti-diagonale et des $0$ ailleurs, la nouvelle distribution de l'erreur est $J\cdot\text{M}_f^d\cdot D_{\alpha q}$. Pour obtenir à nouveau une gaussienne dont la matrice de covariance est diagonale, il suffit alors de majorer les valeurs singulières de la nouvelle distribution, et de choisir le majorant comme variance de la gaussienne diagonale. Or dans notre cas, on a clairement $\|J\|=1$ et $\|\text{M}_f\| \leq d\text{EF}(f)=dS$, d'où $\alpha'=\alpha d S$, comme annoncé dans le Théorème 2.1. \\
\newpage
\subsection{Effets géométriques}

Comme on a pu le voir dans la définition du problème BDD, la difficulté d'une instance $x$ dans un réseau $\mathcal{L}$ est reliée au facteur $\gamma$, que l'on peut écrire $\gamma = \frac{\lambda_1}{\text{dist}(x,\mathcal{L})}$. Plus $\gamma$ est petit, plus l'instance est difficile, et inversement. 

\begin{defin}
On appelle volume d'un réseau $\mathcal{L}=\mathcal{L}(B)$ la quantité $\sqrt{\det{B}}$. Elle ne dépend pas de la base choisie.
\end{defin}

Le théorème suivant donne alors une première borne sur $\lambda_1$ :
\begin{theorem}\textbf{(Minkowski)}
Dans un réseau $\mathcal{L}$ de dimension $n$, $\lambda_1 \leq \sqrt{n}\cdot\text{vol}(\mathcal{L})^\frac{1}{n}$
\end{theorem}

De plus, dans des réseaux aléatoires, on a l'estimation suivante : 
\begin{theorem}
Dans un réseau aléatoire, $\lambda_1$ est en moyenne de l'ordre de la borne de Minkowski, i.e $\lambda_1 \simeq \text{vol}(\mathcal{L})^\frac{1}{n}$
\end{theorem}

On admet pour l'instant que ce second théorème s'applique dans notre cas particulier de réseaux structurés, et on conclut donc que : $\gamma = \frac{\text{vol}(\mathcal{L})^\frac{1}{n}}{\text{dist}(x,\mathcal{L})}$. \\

Ainsi, les deux caractéristiques des réseaux permettant d'estimer la complexité du problème BDD associé sont leur volume, et la distance moyenne du point choisi.  Dans ce qui suit, on se propose donc d'étudier ces deux quantités dans le cadre de la réduction précédemment présentée.

\subsubsection{Évolution du volume }
Si $(A_i)_{i \leq t}$ est une famille de matrices, on désigne par $[A_{i\leq t}]$ la matrice par blocs qui correspond à l'empilement des  $(A_i)_{i \leq t}$ . \\
Pour $A$ et $B$ des matrices, on désigne par $[A|B]$ la matrice dont les colonnes sont celles de $A$, puis celles de $B$. \\

Afin d'étudier les effets de cette réduction, on remarque que $3$ réseaux distincts apparaissent, et on se propose donc d'en étudier les propriétés : 
\begin{itemize}
\item Le réseau initial $\mathcal{L}_0 = \{ y \in \mathbb{Z}^t \ | \ \exists x\in \mathbb{Z}^m,\ y=[\text{Rot}_f(a_i)_{i\leq t}]\cdot x \text{ mod }q \}$
\item Le réseau intermédiaire $\mathcal{L}_1 =\{ y \in \mathbb{Z}^t \ | \ \exists x\in \mathbb{Z}^d,\ y=[\text{Rot}_f^d(a_i)_{i\leq t}]\cdot x \text{ mod }q \}$  qui correspond au projeté en dimension $d$ du réseau initial
\item Le réseau final $\mathcal{L}_2 = \{ y \in \mathbb{Z}^t \ | \ \exists x\in \mathbb{Z}^d,\ y=[\text{Toep}^{d,n}(a'_i)_{i\leq t}]\cdot x \text{ mod }q\}$ \\
\end{itemize}

On clairement que $\mathcal{L}_0$ est engendré par les colonnes de la matrice $[[\text{Rot}_f(a_i)_{i\leq t}] \ |\ q\text{Id}_t]$. En particulier, son sous-espace engendré est égal à l'espace entier (ou encore son rang est égal à la dimension ambiente), on dit que c'est un réseau de \textit{rang plein}. De plus, ce réseau contient les $(0,\dots,q,\dots,0)^\top$, dans ce cas il est dit \textit{q-aire}.\\

\begin{lemma}
Si $a_1$ est inversible modulo $f$, alors $\mathcal{L}_0$ est engendré par 
$$ \left[\begin{array}{c|ccc}
\text{Id}_m & 0 &\cdots &0\\
\text{Rot}_f(a_2)\cdot\text{Rot}_f(a_1)^{-1}&q&\cdots & 0\\
\vdots & &\ddots & \vdots\\
\text{Rot}_f(a_t)\cdot\text{Rot}_f(a_1)^{-1}& 0 & \cdots &q\\
\end{array}\right] $$
\end{lemma}
\textbf{Preuve :} \\
Pour alléger les notations, on pose $A_i := \text{Rot}_f(a_i)$ et $A:=[\text{Rot}_f(a_i)_{i\leq t}]$. Premièrement, si $a_1$ est inversible modulo $f$, alors $A_1$ est inversible. En effet, on a $\text{Rot}_f(a_1)\cdot\text{Rot}_f(a_1^{-1})=\text{Rot}_f(a_1\cdot a_1^{-1})=\text{Rot}_f(1)=\text{Id}_m$, d'où $\text{Rot}_f(a_1)^{-1}=\text{Rot}_f(a_1^{-1})$. On peut alors remarquer que : \\

$(\subseteq)$ Si $y \in \mathcal{L}_0$, alors il existe $x$ tel que $y=Ax \text{ mod q}$, donc en notant $x':=\text{Rot}_f(a)\cdot x$, on a \\ $y=A\cdot\text{Rot}_f(a)^{-1}\cdot x' \text{ mod q}$, d'où 
$$ \left[\begin{array}{c|cccc}
\text{Id}_m \\
\text{Rot}_f(a_2)\cdot\text{Rot}_f(a_1)^{-1} & & q\cdot \text{Id}\\
\vdots &\\
\text{Rot}_f(a_t)\cdot\text{Rot}_f(a_1)^{-1}&\\
\end{array}\right] $$
engendre $\mathcal{L}_0$. Alors, des combinaisons linéaires des colonnes du bloc de gauche permettent de retirer les $m$ premières colonnes du bloc de droite (ces dernières étant engendrées modulo $q$ par le bloc de gauche). Finalement, on a bien que les vecteurs voulus engendrent $\mathcal{L}_0$. \\

$(\supseteq)$ Réciproquement, il suffit de remonter les calculs, tout étant inversible.

\begin{theorem}

Si l'un des $a_i$ est inversible modulo $f$, alors $\text{vol}(\mathcal{L}_0) = q^{m(t-1)}$
\end{theorem}
\textbf{Preuve :}\\
On commence par remarquer que quitte à permuter les $a_i$, la forme précédente est valable dès qu'au moins l'un d'entre eux est inversible modulo $f$. Il suffit alors de dire que les colonnes de la matrice constituée sont linéairement indépendantes. Or cette matrice est triangulaire inférieure (à termes diagonaux non nuls), donc ses colonnes sont libres, et de plus son déterminant vaut le produit des termes diagonaux, ce qui achève la preuve.
\section{Schéma de chiffrement}

\subsection{Preuve de correction}
On se propose tout d'abord de détailler la preuve de correction du schéma de chiffrement proposé dans \cite{mplwe} : \\

On rappelle le cadre de la preuve : $s \hookleftarrow \mathcal{U}(\mathbb{Z}^{n+d+k-1}[X])$, pour $i\leq t$ on a $a_i \hookleftarrow \mathcal{U}(\mathbb{Z}^n[X])$ ; $e_i \hookleftarrow \lfloor D_{\alpha q}\rceil[X]^{<k+d}$ et finalement $r_i \hookleftarrow \mathcal{U}(\{0,1\}^{<k+1}[X])$. On note $e_i(j)$ le $j$-ème coefficient de $e_i$. Le but est d'avoir avec bonne probabilité que : 
\[\|\mu + 2\sum_{i \leq t}r_i \odot_d e_i  \|_\infty < q/2 \] où $\mu$ est le message à chiffrer. 
\begin{theorem}
Si $\alpha \leq \frac{1}{16(k+1)t\sqrt{\lambda}}$ et  $12td(k+1)\leq qd\leq e^\lambda$, alors pour tout texte $\mu$, avec probabilité $\geq 1 - 2^{-\Omega(\lambda)}$ sur $\texttt{(sk,pk)}\hookleftarrow\texttt{KeyGen} $, on a $\texttt{Decrypt(sk,Encrypt(pk,mu))= mu}$ 
\end{theorem}
\textbf{Preuve :}
On commence par donner une borne classique sur la distribution gaussienne : 
\begin{eqnarray*}
\mathbb{P}_{X \hookleftarrow \mathcal{N}(\sigma^2)}(|X| \geq M) &=& \frac{2}{\sigma \sqrt{2 \pi}} \int_{M}^\infty e^{-\frac{t^2}{2 \sigma^2}} \, \mathrm{d}t \\
&\leq &  \frac{2}{\sigma \sqrt{2 \pi}}\int_{M}^\infty \frac{t}{M} e^{-\frac{t^2}{2 \sigma^2}} \, \mathrm{d}t \\
& \leq & \frac{2\sigma}{M \sqrt{2 \pi}} [-e^{-\frac{t^2}{2 \sigma^2}}]_M^\infty \\
& \leq & \frac{2\sigma}{M \sqrt{2 \pi}} e^{-\frac{M^2}{2 \sigma^2}}
\end{eqnarray*}


De plus, si on note $E := \max_{i,j} |e_i(j)|$, on a que :  \\
\begin{eqnarray*}
|(r_i \odot_d e_i)_{l\text{-eme}}| &=& |(r_i\times e_i)_{l+k\text{-eme}}| \\
&=& |\sum_{j=0}^{k+l}r_i(j)e_i(k+l-j)| \\
&\leq& (k+1)E
\end{eqnarray*}

Donc $|(\sum_{i \leq t}r_i \odot_d e_i)_{l\text{-eme}}|\leq t(k+1)E$. \\

Alors, on obtient que : 
\begin{eqnarray*}
\mathbb{P}(\|\mu + 2\sum_{i \leq t}r_i \odot_d e_i  \|_\infty \geq q/2 ) &\leq& \mathbb{P}(1+2E \geq \frac{q}{2t(k+1)}) \\
&\leq& \mathbb{P}(\bigcup_{i,j}|e_i(j)| \geq \frac{q}{4t(k+1)} - \frac{1}{2}) \\
&\leq& (k+d)t \ \mathbb{P}_{X \hookleftarrow \mathcal{N}(\alpha^2 q^2)}(|X| \geq \frac{q}{4t(k+1)} - \frac{3}{2}) \\
&\leq& \frac{8t^2(k+1)(k+d)\alpha q}{q - 6t(k+1)} e^{-\frac{1}{2(\alpha q)^2}(\frac{q}{4t(k+1)}-\frac{3}{2})^2} \\
\end{eqnarray*}

En appliquant les hypothèses sur les paramètres de sécurité, on obtient l'inégalité suivante sur l'exposant :

\[
\frac{1}{2(\alpha q)^2}(\frac{q}{4t(k+1)}-\frac{3}{2})^2 \geq \frac{16^2\lambda t^2(k+1)^2}{2q^2}(\frac{q}{4t(k+1)}-\frac{3}{2})^2 
\geq \frac{\lambda}{2}(4-\frac{24t(k+1)}{q})^2
\geq 2\lambda
\]
\\

On majore de même le facteur pré-exponentiel : 

\[
\frac{8t^2(k+1)(k+d)\alpha q}{q - 6t(k+1)} \leq \frac{8t^2(k+1)(k+d)\alpha q}{6t(k+1)}
\leq \frac{4t(k+d)q}{3}\frac{1}{16(k+1)t\sqrt{\lambda}} 
\leq \frac{(k+d)q}{12(k+1)\sqrt{\lambda}}
\leq \frac{qd}{12\sqrt{\lambda}}
\]
\\

Finalement on obtient la borne voulue :
\begin{eqnarray*}
\mathbb{P}(\|\mu + 2\sum_{i \leq t}r_i \odot_d e_i  \|_\infty \geq q/2 ) &\leq&  \frac{qd}{12\sqrt{\lambda}}e^{-2\lambda} \\
&\leq& e^{-\lambda-\log(12\sqrt{\lambda})} \\
&\leq& 2^{-\Omega(\lambda)}
\end{eqnarray*}
$\hfill \square$

\section*{Annexe}

\printbibliography[heading=bibintoc, title={Références}]
\end{document}







































